"use strict";function ledPanel(){function t(t){var n,f=a,d=a,h=[],s=0;if(g.log)var m=performance.now();v||(l.fillStyle=g.bgColor,l.fillRect(0,0,o.width,o.height)),t.forEach(function(t){if(h=t.slice(0,c),!v||h[0]===!0)for(var o=1;o<h.length;o++)g.rainbow&&(g.activeColor="hsl("+Math.round(o/h.length*360)+", 100%, 50%)"),n=1==h[o]?g.activeColor:g.inactiveColor,v&&u[s][o]!==h[o]?(l.fillStyle=g.bgColor,l.fillRect(f-i*(1+g.margin),d-i*(1+g.margin),2*i*(1+g.margin),2*i*(1+g.margin)),e(f,d,n)):v||e(f,d,n),f+=r;d+=r,f=a,u[s]=h,s++}),g.log&&(m=performance.now()-m,console.log("fillDots: "+Math.round(m)+"; fps: "+Math.round(1e3/m))),v=!0}function e(t,e,n){l.fillStyle=n,l.beginPath(),l.arc(t,e,i,0,2*Math.PI),l.closePath(),l.fill()}function n(){var e,o=[];setTimeout(function(){requestAnimationFrame(n),e=0,h.forEach(function(t){s+c>=t.length?o[e]=t.slice(0,1).concat(t.slice(s+1,s+c+1).concat(t.slice(1,s+c-t.length+1))):o[e]=t.slice(0,1).concat(t.slice(s+1,s+c+1)),e++}),t(o),s==h[0].length&&(s=0),s++},f)}var o,l,i,a,r,f,d,c,g={bgColor:"#000",rainbow:!0,activeColor:"#15b515",inactiveColor:"#325032",depth:60,margin:.5,font:"200px Arial Black",paddingLeft:10,paddingBottom:180,default:{text:"Hello world",radius:3},log:!1},h=[],u=[],s=0,v=!1;this.build=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.default.text,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g.default.radius;o=document.getElementById(e),l=o.getContext("2d"),l.font=g.font,i=f,a=1.5*i,r=(2+g.margin)*i,d=Math.floor(o.height/r),c=Math.floor(o.width/r)+1;var u,s,v,m=l.measureText(n).width,p=0;if(g.log)var w=performance.now();do{var C,b,y=a,M=a;l.fillStyle="#000",l.fillRect(0,0,o.width,o.height),l.fillStyle="#fff",l.fillText(n,g.paddingLeft-p,g.paddingBottom);for(var x=0;x<d;x++){"undefined"==typeof h[x]?(h[x]=[],C=h[x].length+1,b=h[x].length+c):(C=h[x].length,b=h[x].length+c-1),"undefined"==typeof h[x][0]&&(h[x][0]=!1);for(var L=C;L<b;L++){v=0,s=0,u=l.getImageData(y-i,M-i,2*i,2*i);for(var B=0;B<u.data.length;B+=4)s+=u.data[B]+u.data[B+1]+u.data[B+2],v++;s/v/3>255*g.depth/100?(h[x][L]=1,h[x][0]=!0):h[x][L]=0,y+=r}M+=r,y=a}p+=o.width}while(m-p>0);g.log&&(w=performance.now()-w,console.log("Build: ",w)),t(h)},this.animate=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;f=1e3/t,n()}}document.addEventListener("DOMContentLoaded",function(){var t=new ledPanel;t.build("ledpanel","     Running LED Lights",3),t.animate(30)});